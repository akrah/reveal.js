<!doctype html>
<!-- **************************************************************************
 * HTML Template used by Pandoc to generate Reveal.js slides
 * from a Markdown file.
 *
 * In order to use it, Define the parameter 'template: akrah' in the
 * config file config.yml of your project.
 *
 * MIT licensed.
 *
 * Copyright (C) 2018 Adrien Krähenbühl
 ************************************************************************** -->
<html lang="fr">
<head>
    <title>W31 - Programmation Web<br>côté serveur</title>
    <meta charset="utf-8">
    <meta name="description" content="W31 - Programmation Web<br>côté serveur">
    <meta name="author" content="Adrien Krähenbühl">
    <link rel="stylesheet" href="dist/reveal.css">
    <link rel="stylesheet" href="dist/theme/fonts/palatino/palatino.css">
    <link rel="stylesheet" href="dist/theme/fonts/source-sans-pro/source-sans-pro.css">
    <link rel="stylesheet" href="dist/theme/fonts/league-gothic/league-gothic.css">
    <link rel="stylesheet" href="dist/theme/iutrs.css">
    <style>
    .reveal .first-slide .slide-background-content {
        background-image: url(img/firstPage2.png);
        opacity: 0.3;
    }
    .reveal .slides .first-slide h4 {
        font-family: monospace;
        font-style: normal;
        font-size: 1.3em;
    }
    .reveal {
        font-family: "Palatino";
    }
    .reveal h2,
    .reveal h3,
    .reveal h4,
    .reveal h5,
    .reveal h6 {
        font-family: "Palatino";
    }
    .reveal .slides h1 {
        font-family: "League-Gothic";
    }
    .reveal .slides h2:not(:only-child) {
        font-family: "League-Gothic";
    }
    </style>
    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="plugin/highlight/tomorrow-night-eighties.css">
        </head>
<body>


<div class="reveal">
<div class="slides">

<section class="slide level2 first-slide">
<h1>W31 - Programmation Web<br>côté serveur</h1>
<h4><?php echo "1. Introduction à PHP"; ?></h4>
<address>
    <a href="http://adrien.krahenbuhl.fr">Adrien Krähenbühl</a>
    
<time>3 septembre 2020</time>
    <a href="http://iutrs.unistra.fr/formation/dut/dut-informatique">IUT Robert Schuman</a>
    
</address>
</section>

<!--===========================================================================
                              <Begin Markdown>                              -->

<section id="déroulement-du-module" class="slide level2 chapter">
<h2>Déroulement du module</h2>
</section>
<section id="présentations" class="slide level2">
<h2>Présentations</h2>
<h3 id="équipe-pédagogique">Équipe pédagogique</h3>
<dl>
<dt>Adrien Krähenbühl</dt>
<dd>CMx + Groupe 12 de TDs/TPs
</dd>
</dl>
<div class="columns">
<div>
<dl>
<dt>Gabriel Frey</dt>
<dd>Groupe 34 de TDs/TPs
</dd>
</dl>
</div><div>
<dl>
<dt>Gil Gross</dt>
<dd>Groupe 56 de TDs/TPs
</dd>
</dl>
</div>
</div>
<h3 id="séances">Séances</h3>
<pre class="php contenteditable centerh"><code>&lt;?php
    $CM     =  3;
    $TDs    =  4;
    $TPs    = 13;
    $nbHeures = ($CM + $TDs + $TPs) * 2;

    echo &#39;Nb. heures = &#39;.$nbHeures;
?&gt;</code></pre>
</section>
<section id="détail-des-séances" class="slide level2">
<h2>Détail des séances</h2>
<h3 id="contenu">Contenu</h3>
<div class="columns centerh images">
<ol type="1">
<li>Syntaxe PHP</li>
<li>Communication avec un serveur</li>
<li>Programmation objet</li>
<li>BDD : persistance des données</li>
<li>Framework PHP : Laravrel</li>
</ol><p><img data-src="img/logoPhpMysql.png" class="width-70" /></p>
</div>
<p><em>Note : Le contenu est construit sur la base du <a href="http://www.iut.fr/files/fck/File/documents/PPN/fran%C3%A7ais/PPN_INFORMATIQUE_256097.pdf">PPN 2013</a> (page 45).</em></p>
<h3 id="répartition">Répartition</h3>
<ul>
<li>Syntaxe et serveur : <strong>1</strong> CM + <strong>1</strong> TD + <strong>3</strong> TPs</li>
<li>POO et BDD : <strong>1</strong> CM + <strong>1</strong> TD + <strong>3</strong> TPs</li>
<li>Laravel : <strong>1</strong> CM + <strong>2</strong> TD + <strong>7</strong> TPs</li>
</ul>
</section>
<section id="évaluation-du-module" class="slide level2">
<h2>Évaluation du module</h2>
<h3 id="trois-notes">Trois notes</h3>
<dl>
<dt>2 notes de suivi</dt>
<dd>Après les deux derniers CMx.
</dd>
<dt>1 note finale</dt>
<dd>Examen sous forme de TP noté en Janvier.
</dd>
</dl>
<h3 id="calcul-de-votre-moyenne">Calcul de votre moyenne</h3>
<pre class="php contenteditable centerh"><code>&lt;?php
    /* $note1   QCM sur la 1ère partie
     * $note2   QCM sur la 2nde partie
     * $noteTP  TP noté sur machine en Janvier */
    function noteFinale( $note1, $note2, $noteTP )
    {
        return ($note1 + $note2) / 2 * 0.4 + $noteTP * 0.6;
    }
?&gt;</code></pre>
</section>
<section id="lenvironnement-php" class="slide level2 chapter">
<h2>L’environnement PHP</h2>
</section>
<section id="php-cest-quoi" class="slide level2">
<h2>PHP, c’est quoi ?</h2>
<pre class="php contenteditable centerh"><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;...&lt;/head&gt;
    &lt;body&gt;
        &lt;p&gt;&lt;?php echo &quot;Hello IUT !&quot;; ?&gt;&lt;/p&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p><br />
<strong>PHP</strong> est un langage de programmation :</p>
<ul>
<li>principalement utilisé <strong>côté serveur</strong></li>
<li>qui peut être embarqué dans du HTML</li>
<li>open source</li>
<li><span><strong>interprété</strong></span> <span class="fragment"><em>(En fait non, mais on va faire comme si ;))</em><br>                                 <img data-src="img/thinksmart.gif" class="width-30" /></span></li>
</ul>
</section>
<section id="php-pourquoi" class="slide level2">
<h2>PHP, pourquoi ?</h2>
<p><strong>PHP</strong>, c’est le langage de programmation utilisé par <strong>80%</strong> des sites web au niveau mondial.</p>
<div class="images centerh">
<p><a href="https://w3techs.com/technologies/history_overview/programming_language"><img data-src="https://w3techs.com/diagram/history_overview/programming_language/ms/m" class="width-80" /></a></p>
</div>
<p class="centerh">
<em>Javascript, c’est seulement <span class="math inline">\(\approx0.8\%\)</span></em>
</p>
</section>
<section id="php-sur-un-serveur" class="slide level2 chapter">
<h2>PHP sur un serveur</h2>
</section>
<section id="quelques-définitions" class="slide level2">
<h2>Quelques définitions</h2>
<div class="columns">
<div>
<dl>
<dt>Client</dt>
<dd>Envoie une requête et attend une réponse.
</dd>
</dl>
</div><div>
<dl>
<dt>Serveur</dt>
<dd>Attend une requête, la traite et envoie une réponse.
</dd>
</dl>
</div>
</div>
<hr>
<dl>
<dt>Protocole HTTP</dt>
<dd>Ensemble de <strong>règles</strong> à respecter pour transmettre des informations entre un client et un serveur. Ce protocole dispose de plusieurs <strong>méthodes</strong> dont GET et POST.
</dd>
</dl>
<hr>
<div class="columns">
<div>
<dl>
<dt>Requête/réponse HTTP</dt>
<dd>Messages entre client et serveur via le <strong>protocole</strong> HTTP.
</dd>
</dl>
</div>
<div>
<dl>
<dt>Serveur HTTP</dt>
<dd><strong>Logiciel</strong> qui traite les requêtes HTTP reçues par le serveur web.
</dd>
</dl>
</div>
</section>
<section id="interactions-client-serveur" class="slide level2">
<h2>Interactions client-serveur</h2>
<p class="r-stack">
<img data-src="img/clientserveur1.png" class="fragment" /> <img data-src="img/clientserveur2.png" class="fragment" /> <img data-src="img/clientserveur3.png" class="fragment" /> <img data-src="img/clientserveur4.png" class="fragment" /> <img data-src="img/clientserveur5.png" class="fragment" /> <img data-src="img/clientserveur6.png" class="fragment" /> <img data-src="img/clientserveur7.png" class="fragment" /> <img data-src="img/clientserveur8.png" class="fragment" /> <img data-src="img/clientserveur1.png" class="fragment" /> <img data-src="img/clientserveur9.png" class="fragment" /> <img data-src="img/clientserveur10.png" class="fragment" /> <img data-src="img/clientserveur11.png" class="fragment" /> <img data-src="img/clientserveur12.png" class="fragment" /> <img data-src="img/clientserveur13.png" class="fragment" /> <img data-src="img/clientserveur14.png" class="fragment" /> <img data-src="img/clientserveur15.png" class="fragment" /> <img data-src="img/clientserveur16.png" class="fragment" /> <img data-src="img/clientserveur17.png" class="fragment" />
</p>
</section>
<section id="configuration-du-serveur-http" class="slide level2 centerh">
<h2>Configuration du serveur HTTP</h2>
<div class="columns images centerh">
<p><img data-src="img/logoNginx.png" class="width-70" /></p><p><img data-src="img/logoApache.png" class="width-50" /></p>
</div>
<div class="r-stack">
<div class="fragment fade-out">
<p>C’est la configuration du serveur HTTP qui précise les <strong>conditions nécessaires</strong> pour qu’une requête soit transmise au module PHP.</p>
<p>Cela peut être :</p>
<ul>
<li>si la requête comporte une URL spécifique</li>
<li>si la requête comporte une extension .php</li>
<li>si la requête est envoyé sur un port particulier</li>
<li>une combinaison de ces règles</li>
<li>une autre règle</li>
</ul>
</div>
<div class="fragment">
<pre class="contenteditable"><code>server {
    listen 80;
    server_name site.fr;

    # Path to the root of your installation
    root /var/www/site.fr/;
    index index.php;

    location ~ \.php$ {
        ...
        fastcgi_pass module-php;
        ...
    }
}</code></pre>
<p><em>Exemple de fichier de configuration de Nginx.</em></p>
</div>
</div>
</section>
<section id="syntaxe-environnement" class="slide level2 chapter">
<h2>Syntaxe &amp; environnement</h2>
</section>
<section id="les-variables" class="slide level2">
<h2>Les variables</h2>
<div class="columns">
<div>
<pre class="php contenteditable fragment"><code>// Commentaire sur une ligne

/* Commentaire sur
 * plusieurs lignes */</code></pre>
<pre class="php contenteditable fragment"><code>// Déclaration et affectation de variables
$a;
$a = 8;
$b = 10;</code></pre>
<pre class="php contenteditable fragment"><code>// Définition d&#39;une constante
const NOM_MODULE = &#39;W31&#39;;</code></pre>
<pre class="php contenteditable fragment"><code>// Chaînes de caractères
$message = &#39;calcul sur &#39; . $a . &#39; et &#39; . $b;</code></pre>
</div><div>
<pre class="php contenteditable fragment"><code>// Opérateurs arithmétiques
$res = $a + $b;
$res *= $b - $a;</code></pre>
<pre class="php contenteditable fragment"><code>// Test d&#39;existence d&#39;une variable
isset($res);</code></pre>
<pre class="php contenteditable fragment"><code>// Test sur le type d&#39;une variable
is_int($a);    // true
is_string($b); // false</code></pre>
<pre class="php contenteditable fragment"><code>/* Obtenir le type d&#39;une variable
   sous forme de chaine de caractères */
gettype($a);       // &#39;integer&#39;
gettype($message); // &#39;string&#39;</code></pre>
</div>
</div>
<div class="fragment centerh">
<blockquote>
<p>Attention au typage dynamique !</p>
<pre class="php contenteditable"><code>$a = 10;          // a est un entier
echo gettype($a); // &#39;integer&#39;
$a = &quot;dix&quot;;       // a est maintenant une chaine de caractères
echo gettype($a); // &#39;string&#39;</code></pre>
</blockquote>
</div>
</section>
<section id="les-tableaux" class="slide level2">
<h2>Les tableaux</h2>
<blockquote>
<p>En PHP, tous les tableaux sont<br />
des <strong>tableaux associatifs</strong> (dictionnaires).</p>
</blockquote>
<div class="columns">
<div>
<pre class="php contenteditable fragment"><code>/* Déclaration d&#39;un tableau */

// 1. Avec des clés implicites
$tab1 = [1,&#39;deux&#39;,3] // Avant : array(1,2,3);
echo $tab1[1]; // &#39;deux&#39;

// 2. Avec clés explicites
$tab3 = [ 0 =&gt; 1, 1 =&gt; &#39;deux&#39;, 2 =&gt; 3 ];
echo $tab3[2]; // 3</code></pre>
<pre class="php contenteditable fragment"><code>// Taille d&#39;un tableau
count($tab1);</code></pre>
<pre class="php contenteditable fragment"><code>// Afficher un tableau
print_r($tab1);
/* Array ( [0] =&gt; 1
*          [1] =&gt; 2
*          [2] =&gt; 3 ) */</code></pre>
</div><div>
<pre class="php contenteditable fragment"><code>/* - Une clé peut être un entier ou une
 *   chaine de caractères
 * - Une valeur peut être de n&#39;importe
 *   quel type */
$notes = [
    &#39;Jean&#39;  =&gt; 3,
    &#39;Simon&#39; =&gt; 12.3,
    &#39;Alex&#39;  =&gt; &#39;Absent&#39;,
    12      =&gt; [&#39;Paul&#39;,&#39;Robert&#39;]
];
echo $notes[&#39;Jean&#39;]; // Affiche 3</code></pre>
<pre class="php contenteditable fragment"><code>// Ajout d&#39;un élément à un tableau
$notes[&#39;Étienne&#39;] = 8;
$notes[] = 9; // Ajout (13 =&gt; 9) à $notes</code></pre>
<pre class="php contenteditable fragment"><code>// Suppression d&#39;un élément
unset($notes[12]);</code></pre>
</div>
</div>
</section>
<section id="les-structures-de-contrôle" class="slide level2 centerh">
<h2>Les structures de contrôle</h2>
<div class="columns">
<div>
<pre class="php contenteditable fragment"><code>// Conditionnelle
if ($load &lt; 100) {
    echo &#39;Chargement en cours...&#39;;
}
// La directive &#39;else { ... }&#39; est facultative
else {
    echo &#39;Chargement terminé !&#39;;
}</code></pre>
<pre class="php contenteditable fragment"><code>// Boucle for
for ($load = 1; $load &lt; 100; $load++) {
    echo &#39;Chargement : &#39;.$load.&#39;/100&#39;;
}</code></pre>
<pre class="php contenteditable fragment"><code>// Boucle while
$load = 1;
while ($load &lt; 100) {
    echo &#39;Chargement : &#39;.$load.&#39;/100&#39;;
    $load++;
}</code></pre>
</div><pre class="php contenteditable fragment"><code>// Itération sur un tableau
$tab = [&quot;W31&quot;,&quot;W11&quot;,&quot;A31&quot;];

// Si on ne veut traiter que les valeurs
foreach( $tab as $module ) {
    echo &quot;J&#39;aime &quot;.$module.&quot;\n&quot;;
}
/* Résultat :
 *   J&#39;aime W31
 *   J&#39;aime W11
 *   J&#39;aime A31 */

// Si on veut traiter les couples
// (clé =&gt; valeur)
foreach( $tab as $i =&gt; $module ) {
    echo $i . &quot;) J&#39;aime &quot;.$module;
}
/* Résultat :
 *   1) J&#39;aime W31
 *   2) J&#39;aime W11
 *   3) J&#39;aime A31 */</code></pre>
</div>
</section>
<section id="la-doc" class="slide level2">
<h2>La doc</h2>
<div class="centerh width-45">
<blockquote>
<p>Une seule référence à retenir :<br />
<strong><a href="http://php.net">http://php.net</a></strong></p>
</blockquote>
</div>
<h3 id="et-stackoverflow-et-autres-forums">Et Stackoverflow (et autres forums) ?</h3>
<ul>
<li>C’est pratique… si vous êtes critique !</li>
<li>Une réponse peut dater et ne plus correspondre à l’API actuelle.</li>
<li>Toutes <strong>les bonnes réponses sont dans la doc officielle</strong>, et celle de PHP est très complète.</li>
<li>Une bonne partie des “solutions” cite la doc : gagnez du temps !</li>
</ul>
<div class="columns centerh width-70 images">
<p><img data-src="img/logoPHP.png" class="width-70" /></p><p><span class="math inline">\(\gg\)</span></p><p><img data-src="img/logoStackoverflow.svg" class="width-80" /></p>
</div>
</section>
<section id="php-et-html" class="slide level2">
<h2>PHP et HTML</h2>
<div class="columns centerh">
<div>
<pre class="html contenteditable"><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot;&gt;
        &lt;title&gt;Ma première page PHP&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;p&gt;Hello W31 !&lt;/p&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p><code>fullHTML.php</code></p>
</div><div>
<pre class="php contenteditable"><code>&lt;?php echo &#39;&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot;&gt;
        &lt;title&gt;Ma première page PHP&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;p&gt;Hello W31 !&lt;/p&gt;
    &lt;/body&gt;
&lt;/html&gt;&#39;;</code></pre>
<p><code>fullPHP.php</code></p>
</div>
</div>
<p>
<p>Un fichier d’extension <code>.php</code> peut contenir :</p>
<ul>
<li>uniquement du HTML</li>
<li>uniquement du PHP</li>
<li>un mélange de PHP et de HTML</li>
</ul>
</p>
</section>
<section id="coexistence-phphtml" class="slide level2">
<h2>Coexistence PHP/HTML</h2>
<div class="columns centerh">
<div>
<pre class="php contenteditable"><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;HTML produit par PHP&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
    &lt;?php
        $num = rand(1,10);
        if ( $num &lt; 5 ) {
            echo &#39;&lt;p&gt;Inférieur à cinq&lt;/p&gt;&#39;;
        } else {
            echo &#39;&lt;p&gt;Supérieur à cinq&lt;/p&gt;&#39;;
        }
    ?&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p><code>page.php</code></p>
</div><div>
<pre class="php contenteditable"><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;HTML controlé par PHP&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;?php
            $num = rand(1,10);
            if ( $num &lt; 5 ) {
        ?&gt;
            &lt;p&gt;Inférieur à cinq&lt;/p&gt;
        &lt;?php } else { ?&gt;
            &lt;p&gt;Supérieur à cinq&lt;/p&gt;
        &lt;?php } ?&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p><code>memePage.php</code></p>
</div>
</div>
<p>Le PHP peut être alterné avec du HTML :</p>
<ul>
<li>cela permet de dissocier le contrôle du contenu</li>
<li>mais attention à la <strong>cohérence</strong> du code PHP disséminé !</li>
</ul>
</section>
<section id="inclusion-de-fichiers" class="slide level2">
<h2>Inclusion de fichiers</h2>
<pre class="php contenteditable centerh"><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;?php require(&#39;head.php&#39;); ?&gt;
    &lt;body&gt;
        &lt;?php require(&#39;header.php&#39;); ?&gt;
        &lt;main&gt;...&lt;/main&gt;
        &lt;?php require(&#39;footer.php&#39;); ?&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p><br />
Les instructions <a href="http://php.net/manual/fr/function.include.php"><code>include</code></a> et <a href="http://php.net/manual/fr/function.require.php"><code>require</code></a> permettent d’insérer un fichier PHP au sein d’un autre fichier. Cela <strong>évite la redondance de code</strong>.</p>
<p>Si le fichier demandé n’existe pas :</p>
<ul>
<li><a href="http://php.net/manual/fr/function.require.php"><code>require</code></a> <strong>stoppe l’exécution</strong> du script</li>
<li><a href="http://php.net/manual/fr/function.include.php"><code>include</code></a> se contente de <strong>transmettre un “warning”</strong></li>
</ul>
<div class="fragment">
<p><strong>Variantes</strong> : <a href="http://php.net/manual/fr/function.include-once.php"><code>include_once</code></a> et <a href="http://php.net/manual/fr/function.require-once.php"><code>require_once</code></a> n’insèrent un fichier que si celui-ci n’a pas déjà été inclut.</p>
<!-- ------------------------------------------------------------------------------- -->
<!-- ## Pause de 5 minutes {.chapter} -->
</div>
</section>
<section id="transmettre-des-données" class="slide level2 chapter">
<h2>Transmettre des données</h2>
</section>
<section id="mécanismes-de-transmission" class="slide level2">
<h2>Mécanismes de transmission</h2>
<p>PHP exploite deux mécanismes liés à deux protocoles HTTP pour échanger des données avec le client :</p>
<dl>
<dt>L’URL</dt>
<dd><ul>
<li>le client concatène les données à la fin de l’url</li>
<li>le module PHP analyse l’URL et stocke les données dans le tableau global <a href="http://php.net/manual/fr/reserved.variables.get.php"><code>$_GET</code></a></li>
</ul>
</dd>
</dl>
<div class="fragment">
<dl>
<dt>Le formulaire HTML</dt>
<dd><ul>
<li>le client insère les données dans l’entête du protocole HTTP</li>
<li>le module PHP analyse l’entête HTTP et stocke les données dans le tableau global <a href="http://php.net/manual/fr/reserved.variables.post.php"><code>$_POST</code></a></li>
</ul>
</dd>
</dl>
</div>
</section>
<section id="transmission-via-lurl-get" class="slide level2 centerh">
<h2>Transmission via l’URL (GET)</h2>
<p>Si le client envoie l’URL suivante comme requête au serveur :</p>
<pre class="http contenteditable"><code>http://site.fr/index.php?module=W31&amp;nbEns=3</code></pre>
<div class="fragment centerh images">
<p>et que le script <code>index.php</code> est le suivant :</p>
<pre class="php contenteditable"><code>&lt;?php
    echo &#39;Le module s\&#39;appelle &#39; . $_GET[&#39;module&#39;] . &#39;.&lt;br&gt;&#39;;
    echo &#39;Il est composé de &#39; . $_GET[&#39;nbEns&#39;] . &#39; intervenants.&#39;;
?&gt;</code></pre>
</div>
<div class="fragment centerh images">
<p>alors le client recevra le contenu suivant :</p>
<pre class="html contenteditable"><code>Le module s&#39;appelle W31.&lt;br&gt;Il est composé de de 3 intervenants.</code></pre>
</div>
<p class="fragment">
qui sera interprété comme du HTML.
</p>
</section>
<section id="transmission-via-un-formulaire-post" class="slide level2 centerh">
<h2>Transmission via un formulaire (POST)</h2>
<p>Si le client envoie le formulaire suivant au serveur :</p>
<pre class="html contenteditable"><code>&lt;form method=&quot;post&quot; action=&quot;index.php&quot;&gt;
    &lt;input type=&quot;text&quot; name=&quot;nom&quot;&gt;
    &lt;input type=&quot;number&quot; name=&quot;age&quot;&gt;
    &lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;</code></pre>
<div class="fragment centerh images">
<p>et que le script <code>index.php</code> est le suivant :</p>
<pre class="php contenteditable"><code>&lt;?php
    echo &#39;Bonjour &#39; . $_POST[&#39;nom&#39;] . &#39;.&lt;br&gt;&#39;;
    echo &#39;Êtes-vous sûr d\&#39;avoir &#39; . $_POST[&#39;age&#39;] . &#39; ans ?&#39;;
?&gt;</code></pre>
</div>
<div class="fragment centerh images">
<p>alors le client recevra un contenu semblable à :</p>
<pre class="html contenteditable centerm width-82"><code>Bonjour Bilbo.&lt;br&gt;Êtes-vous sûr d&#39;avoir 142 ans ?</code></pre>
</div>
<p class="fragment">
où le nom et l’âge dépendent des valeurs spécifiées dans le formulaire.
</p>
</section>
<section id="confiance-zero-vérifiez" class="slide level2">
<h2>CONFIANCE ZERO, VÉRIFIEZ !</h2>
<blockquote>
<p>Ne jamais faire confiance aux données transmises par le client,<br />
toujours les vérifier !</p>
</blockquote>
<dl>
<dt>Via une URL</dt>
<dd><p>Un client peut écrire les paramètres qu’il veut dans l’URL, quelle que soit la valeur que vous attendez. Exemple :</p>
<pre class="html"><code>http://site.fr/index.php?module=W31&amp;nbEns=90
http://site.fr/index.php?module=10935&amp;nbEns=&lt;script&gt;alert(&#39;coucou&#39;);&lt;/script&gt;</code></pre>
</dd>
<dt>Via un formulaire</dt>
<dd><p>Un client peut :</p>
<ul>
<li>écrire ce qu’il veut dans une balise <code>input</code>.</li>
<li>écrire son propre formulaire avec pour <code>action</code> votre script.</li>
</ul>
</dd>
</dl>
</section>
<section id="comment-vérifier-et-protéger" class="slide level2">
<h2>Comment vérifier et protéger ?</h2>
<ul>
<li>Vérifier l’existence</li>
</ul>
<pre class="php centerh"><code>if ( isset($_GET[&#39;param1&#39;]) &amp;&amp; isset($_GET[&#39;param2&#39;]) ) { ... }</code></pre>
<ul>
<li>Forcer le type (transtypage)</li>
</ul>
<pre class="php centerh"><code>$val = (int) $_GET[&#39;param1&#39;];</code></pre>
<ul>
<li>Vérifier la valeur</li>
</ul>
<pre class="php centerh"><code>if ($val &lt; 10) { ... }</code></pre>
<ul>
<li>Convertir les caractères spéciaux<br />
<em>Permet d’éviter les injections de code (faille XSS).</em></li>
</ul>
<pre class="php centerh"><code>$val = htmlentities($_GET[&#39;param1&#39;]);</code></pre>
</section>
<section id="les-cookies" class="slide level2 chapter">
<h2>Les cookies</h2>
</section>
<section id="présentation" class="slide level2">
<h2>Présentation</h2>
<div class="columns centerh">
<div class="column-3">
<dl>
<dt>Définition</dt>
<dd>Un cookie est une information <strong>textuelle</strong> indexée par une clé.
</dd>
</dl>
</div><div class="column-2 images centerh">
<p><img data-src="img/cookieChoco.png" class="width-50" /></p>
</div>
</div>
<dl>
<dt><strong>Propriétés</strong></dt>
<dd><p>Un cookie :</p>
<ul>
<li>est <strong>créé par le serveur (PHP)</strong></li>
<li>est <strong>stocké chez le client</strong></li>
<li>transite via le protocole HTTP</li>
<li>a une durée de vie spécifiée à la création</li>
<li>est automatiquement détruit à expiration</li>
</ul>
</dd>
</dl>
</section>
<section id="les-cookies-mode-demploi" class="slide level2">
<h2>Les cookies, mode d’emploi</h2>
<dl>
<dt>Comment créer un cookie ?</dt>
<dd><ol type="1">
<li>Un client fait une requête HTTP</li>
<li>Le fichier associé contient la fonction PHP <a href="https://www.php.net/manual/fr/function.setcookie.php"><code>setcookie()</code></a> :</li>
</ol>
<pre class="php centerm width-70"><code>&lt;?php setcookie( &#39;nom&#39;, &#39;valeur&#39;, time() + 60*60*24*10); ?&gt;</code></pre>
<ol start="3" type="1">
<li>Le cookie <code>'nom' =&gt; 'valeur'</code> est créé lorsque le serveur PHP exécute cette fonction.</li>
<li>Il est transmis au client dans l’entête de la réponse HTTP :</li>
</ol>
<pre class="http centerm width-70"><code>Set-Cookie: nom=valeur; expires=...; path=/; domain=site.fr</code></pre>
<ol start="5" type="1">
<li>Le client stocke le cookie dans un fichier.</li>
</ol>
</dd>
</dl>
<p class="fragment centerm">
… et le serveur n’en garde aucune trace.
</p>
</section>
<section id="création-dun-cookie" class="slide level2">
<h2>Création d’un cookie</h2>
<p class="r-stack">
<img data-src="img/cookies1.png" class="fragment" /> <img data-src="img/cookies2.png" class="fragment" /> <img data-src="img/cookies3.png" class="fragment" /> <img data-src="img/cookies4.png" class="fragment" /> <img data-src="img/cookies5.png" class="fragment" /> <img data-src="img/cookies6.png" class="fragment" /> <img data-src="img/cookies7.png" class="fragment" /> <img data-src="img/cookies8.png" class="fragment" />
</p>
</section>
<section id="les-cookies-mode-demploi-1" class="slide level2">
<h2>Les cookies, mode d’emploi</h2>
<dl>
<dt>Comment exploiter un cookie existant ?</dt>
<dd><ol type="1">
<li>Le client possède un cookie.</li>
<li>Il fait une requête HTTP vers le même serveur.</li>
<li>Le cookie du domaine est ajouté à l’entête de la requête :</li>
</ol>
<pre class="http centerm width-22"><code>Cookie: nom=valeur</code></pre>
<ol start="4" type="1">
<li>Le serveur PHP peut accéder au tableau global <a href="https://www.php.net/manual/fr/reserved.variables.cookies.php"><code>$_COOKIE</code></a> pour exploiter l’information du cookie.</li>
</ol>
</dd>
</dl>
<p><br></p>
<div class="fragment">
<blockquote>
<p>Un serveur peut stocker <strong>plusieurs cookies pour un même domaine</strong>. Lors d’une requête vers ce domaine, ils sont tous ajoutés à l’entête.</p>
</blockquote>
</div>
</section>
<section id="utilisation-dun-cookie" class="slide level2">
<h2>Utilisation d’un cookie</h2>
<p class="r-stack">
<img data-src="img/cookies9.png" class="fragment" /> <img data-src="img/cookies10.png" class="fragment" /> <img data-src="img/cookies11.png" class="fragment" /> <img data-src="img/cookies12.png" class="fragment" /> <img data-src="img/cookies13.png" class="fragment" /> <img data-src="img/cookies14.png" class="fragment" /> <img data-src="img/cookies15.png" class="fragment" /> <img data-src="img/cookies16.png" class="fragment" /> <img data-src="img/cookies17.png" class="fragment" />
</p>
</section>
<section id="cookies-les-3-règles-dor" class="slide level2">
<h2>Cookies, les 3 règles d’or</h2>
<blockquote>
<p>Règle n°1 - L’instruction <a href="https://www.php.net/manual/fr/function.setcookie.php"><code>setcookie()</code></a> doit <strong>TOUJOURS</strong> être appelée <strong>AVANT</strong> le code HTML.</p>
</blockquote>
<div class="width-100">
<blockquote>
<p>Règle n°2 - Un cookie est stocké chez le client, il peut donc le modifier<br />
<span class="math inline">\(\rightarrow\)</span> <strong>TOUJOURS sécuriser le contenu d’un cookie</strong>.</p>
</blockquote>
</div>
<div class="width-80 centerm">
<blockquote>
<p>Règle n°3 - Un client peut refuser de stocker un cookie<br />
<span class="math inline">\(\rightarrow\)</span> <strong>Ne JAMAIS supposer qu’un cookie existe.</strong></p>
</blockquote>
</div>
</section>
<section id="les-sessions" class="slide level2 chapter">
<h2>Les sessions</h2>
</section>
<section id="présentation-1" class="slide level2">
<h2>Présentation</h2>
<dl>
<dt>Définition</dt>
<dd>Une session PHP est un mécanisme permettant de conserver des données d’un client sur le serveur entre plusieurs requêtes.
</dd>
<dt><strong>Propriétés</strong></dt>
<dd><p>Une session :</p>
<ul>
<li>est <strong>créé par le serveur (PHP)</strong></li>
<li>est <strong>stocké sur le serveur</strong></li>
<li>possède un <strong>identifiant unique</strong> attribué à sa création</li>
<li>n’a que son identifiant qui transite via le protocole HTTP, <strong>pas ses données</strong></li>
</ul>
</dd>
</dl>
</section>
<section id="les-sessions-mode-demploi" class="slide level2">
<h2>Les sessions, mode d’emploi</h2>
<dl>
<dt>Comment créer une session ?</dt>
<dd><ol type="1">
<li>Un client fait une requête HTTP</li>
<li>Le fichier associé contient la fonction PHP <a href="https://www.php.net/manual/fr/function.session-start.php"><code>session_start()</code></a> :</li>
</ol>
<pre class="php centerm width-30"><code>&lt;?php session_start(); ?&gt;</code></pre>
<ol start="3" type="1">
<li>Un identifiant unique est créé et associé à la session du client</li>
<li>Un tableau <a href="https://www.php.net/manual/fr/reserved.variables.session.php"><code>$_SESSION</code></a> associé à l’id est créé sur le serveur</li>
<li>L’identifiant est transmis au client par cookie :</li>
</ol>
<pre class="php centerm width-80"><code>Set-Cookie: PHPSESSID=rvPT5v5QVPJ8H_Dh54yWuTfhBDbHZ_BkDC1TaWBn8RxBcDpy</code></pre>
</dd>
</dl>
<p><br></p>
<p class="fragment centerm">
… et le client ne connait donc que son identifiant.
</p>
</section>
<section id="création-dune-session" class="slide level2">
<h2>Création d’une session</h2>
<p class="r-stack">
<img data-src="img/cookies1.png" class="fragment" /> <img data-src="img/cookies2.png" class="fragment" /> <img data-src="img/cookiesSession3.png" class="fragment" /> <img data-src="img/cookiesSession4.png" class="fragment" /> <img data-src="img/cookiesSession5.png" class="fragment" /> <img data-src="img/cookiesSession6.png" class="fragment" /> <img data-src="img/cookiesSession7.png" class="fragment" /> <img data-src="img/cookiesSession8.png" class="fragment" /> <img data-src="img/cookiesSession9.png" class="fragment" />
</p>
</section>
<section id="les-sessions-mode-demploi-1" class="slide level2">
<h2>Les sessions, mode d’emploi</h2>
<dl>
<dt>Comment utiliser une session ?</dt>
<dd><ol type="1">
<li>Le client possède un cookie avec son identifiant de session.</li>
<li>Le client fait une requête HTTP vers le même serveur.</li>
<li>Le cookie de la session du domaine est ajouté à l’entête de la requête :</li>
</ol>
<pre class="http"><code>Cookie: PHPSESSID=rvPT5v5QVPJ8H_Dh54yWuTfhBDbHZ_BkDC1TaWBn8RxBcDpy</code></pre>
<ol start="4" type="1">
<li>Le serveur PHP charge le tableau <a href="https://www.php.net/manual/fr/reserved.variables.session.php"><code>$_SESSION</code></a> associé à l’identifiant.</li>
</ol>
</dd>
</dl>
<p><br></p>
<p class="fragment centerm">
… et peut alors accéder aux variables de session du tableau.
</p>
</section>
<section id="utilisation-dune-session" class="slide level2">
<h2>Utilisation d’une session</h2>
<p class="r-stack">
<img data-src="img/cookiesSession10.png" class="fragment" /> <img data-src="img/cookiesSession11.png" class="fragment" /> <img data-src="img/cookiesSession12.png" class="fragment" /> <img data-src="img/cookiesSession13.png" class="fragment" /> <img data-src="img/cookiesSession14.png" class="fragment" /> <img data-src="img/cookiesSession15.png" class="fragment" /> <img data-src="img/cookiesSession16.png" class="fragment" /> <img data-src="img/cookiesSession17.png" class="fragment" /> <img data-src="img/cookiesSession18.png" class="fragment" /> <img data-src="img/cookiesSession19.png" class="fragment" />
</p>
</section>
<section id="sessions-les-2-règles-dor" class="slide level2">
<h2>Sessions : les 2 règles d’or</h2>
<blockquote>
<p>Règle n°1 - L’instruction <a href="https://www.php.net/manual/fr/function.session-start.php"><code>session_start()</code></a> doit <strong>TOUJOURS</strong> être appelée <strong>AVANT</strong> le code HTML.</p>
</blockquote>
<div class="width-100">
<blockquote>
<p>Règle n°2 - Un client peut refuser de stocker un cookie<br />
<span class="math inline">\(\rightarrow\)</span> ne <strong>JAMAIS</strong> supposer qu’une session existe.</p>
</blockquote>
</div>
</section>

 <!--                         </End Markdown>
 ===========================================================================-->

</div>
</div>

<script src="dist/reveal.js"></script>
<script src="plugin/highlight/highlight.js"></script>
<script src="plugin/math/math.js"></script>
<script src="plugin/reveal.js-menu/menu.js"></script>

<script type="text/javascript">
Reveal.initialize({
// Display presentation control arrows
controls: true,

// Help the user learn the controls by providing hints, for example by
// bouncing the down arrow when they first encounter a vertical slide
controlsTutorial: false,

// Determines where controls appear, "edges" or "bottom-right"
controlsLayout: 'edges',

// Visibility rule for backwards navigation arrows; "faded", "hidden"
// or "visible"
controlsBackArrows: 'faded',

// Display a presentation progress bar
progress: true,

// Display the page number of the current slide
// h.v|h/v|c|c/t
slideNumber: "c/t",

// Can be used to limit the contexts in which the slide number appears
// - "all":      Always show the slide number
// - "print":    Only when printing to PDF
// - "speaker":  Only in the speaker view
showSlideNumber: 'all',

// Use 1 based indexing for # links to match slide number (default is zero
// based)
hashOneBasedIndex: false,

// Add the current slide number to the URL hash so that reloading the
// page/copying the URL will return you to the same slide
hash: false,

// Flags if we should monitor the hash and change slides accordingly
respondToHashChanges: true,

// Push each slide change to the browser history
history: true,

// Enable keyboard shortcuts for navigation
keyboard: true,

// Optional function that blocks keyboard events when retuning false
//
// If you set this to 'foucsed', we will only capture keyboard events
// for embdedded decks when they are in focus
keyboardCondition: null,

// Disables the default reveal.js slide layout (scaling and centering)
// so that you can use custom CSS layout
disableLayout: false,

// Enable the slide overview mode
overview: true,

// Vertical centering of slides
center: false,

// Enables touch navigation on devices with touch input
touch: true,

// Loop the presentation
loop: true,

// Change the presentation direction to be RTL
rtl: false,

// Changes the behavior of our navigation directions.
//
// "default"
// Left/right arrow keys step between horizontal slides, up/down
// arrow keys step between vertical slides. Space key steps through
// all slides (both horizontal and vertical).
//
// "linear"
// Removes the up/down arrows. Left/right arrows step through all
// slides (both horizontal and vertical).
//
// "grid"
// When this is enabled, stepping left/right from a vertical stack
// to an adjacent vertical stack will land you at the same vertical
// index.
//
// Consider a deck with six slides ordered in two vertical stacks:
// 1.1    2.1
// 1.2    2.2
// 1.3    2.3
//
// If you're on slide 1.3 and navigate right, you will normally move
// from 1.3 -> 2.1. If "grid" is used, the same navigation takes you
// from 1.3 -> 2.3.
navigationMode: 'default',

// Randomizes the order of slides each time the presentation loads
shuffle: false,

// Turns fragments on and off globally
fragments: true,

// Flags whether to include the current fragment in the URL,
// so that reloading brings you to the same fragment position
fragmentInURL: false,

// Flags if the presentation is running in an embedded mode,
// i.e. contained within a limited portion of the screen
embedded: false,

// Flags if we should show a help overlay when the questionmark
// key is pressed
help: true,

// Flags if it should be possible to pause the presentation (blackout)
pause: true,

// Flags if speaker notes should be visible to all viewers
showNotes: false,

// Global override for autoplaying embedded media (video/audio/iframe)
// - null: Media will only autoplay if data-autoplay is present
// - true: All media will autoplay, regardless of individual setting
// - false: No media will autoplay, regardless of individual setting
autoPlayMedia: null,

// Global override for preloading lazy-loaded iframes
// - null:   Iframes with data-src AND data-preload will be loaded when within
//           the viewDistance, iframes with only data-src will be loaded when visible
// - true:   All iframes with data-src will be loaded when within the viewDistance
// - false:  All iframes with data-src will be loaded only when visible
preloadIframes: null,

// Can be used to globally disable auto-animation
autoAnimate: true,

// Optionally provide a custom element matcher that will be
// used to dictate which elements we can animate between.
autoAnimateMatcher: null,

// Default settings for our auto-animate transitions, can be
// overridden per-slide or per-element via data arguments
autoAnimateEasing: 'ease',
autoAnimateDuration: 1.0,
autoAnimateUnmatched: true,

// CSS properties that can be auto-animated. Position & scale
// is matched separately so there's no need to include styles
// like top/right/bottom/left, width/height or margin.
autoAnimateStyles: [
'opacity',
'color',
'background-color',
'padding',
'font-size',
'line-height',
'letter-spacing',
'border-width',
'border-color',
'border-radius',
'outline',
'outline-offset'
],

// Number of milliseconds between automatically proceeding to the
// next slide, disabled when set to 0, this value can be overwritten
// by using a data-autoslide attribute on your slides
autoSlide: 0,

// Stop auto-sliding after user input
autoSlideStoppable: true,

// Use this method for navigation when auto-sliding
autoSlideMethod: Reveal.navigateNext,

// Specify the average time in seconds that you think you will spend
// presenting each slide. This is used to show a pacing timer in the
// speaker view
defaultTiming: 120,

// Enable slide navigation via mouse wheel
mouseWheel: false,

// Opens links in an iframe preview overlay
// Add `data-preview-link` and `data-preview-link="false"` to customise each
// link individually
previewLinks: false,

// Exposes the reveal.js API through window.postMessage
postMessage: true,

// Dispatches all reveal.js events to the parent window through postMessage
postMessageEvents: true,

// Focuses body when page changes visibility to ensure keyboard shortcuts work
focusBodyOnPageVisibilityChange: true,

// Transition style
//     none/default/fade/slide/convex/concave/zoom/cube/page/linear
transition: 'slide',

// Transition speed
//     default/fast/slow
transitionSpeed: 'fast',

// Transition style for full page slide backgrounds
//    none/fade/slide/convex/concave/zoom
backgroundTransition: 'fade',

// The maximum number of pages a single slide can expand onto when printing
// to PDF, unlimited by default
pdfMaxPagesPerSlide: Number.POSITIVE_INFINITY,

// Prints each fragment on a separate slide
pdfSeparateFragments: false,

// Offset used to reduce the height of content within exported PDF pages.
// This exists to account for environment differences based on how you
// print to PDF. CLI printing options, like phantomjs and wkpdf, can end
// on precisely the total height of the document whereas in-browser
// printing has to end one pixel before.
pdfPageHeightOffset: -1,

// Number of slides away from the current that are visible
viewDistance: 3,

// Number of slides away from the current that are visible on mobile
// devices. It is advisable to set this to a lower number than
// viewDistance in order to save resources.
mobileViewDistance: 2,

// The display mode that will be used to show slides
display: 'flex',

// Hide cursor if inactive
hideInactiveCursor: true,

// Time before the cursor is hidden (in ms)
hideCursorTime: 5000,

math: { mathjax: 'plugin/math/MathJax.js' },
menu: {
		// Side of the the menu
        // left|right
		side: 'left',
		// Specifies the width of the menu.
		// normal|wide|third|half|full|any valid css length value
		width: 'normal',
		// Slide numbers to the titles in the slide list.
		// false|true|h.v|h/v|c|c/t
		numbers: false,
		// Slide elements used for generating the slide titles
		titleSelector: 'h1, h2',
		// If slides do not have a matching title, attempt to use the
		// start of the text content as the title instead
		useTextContentForMissingTitles: false,
		// Hide slides from the menu that do not have a title.
		hideMissingTitles: false,
		// Adds markers to the slide titles to indicate the
		// progress through the presentation.
		markers: false,
		// Specify custom panels to be included in the menu, by
		// providing an array of objects with 'title', 'icon'
		// properties, and either a 'src' or 'content' property.
		custom: false,
		// Specifies the themes that will be available in the themes
		// menu panel. Set to 'true' to show the themes menu panel
		// with the default themes list. Alternatively, provide an
		// array to specify the themes to make available in the
		// themes menu panel, for example...
		// [
		//     { name: 'Black', theme: 'css/theme/black.css' },
		//     { name: 'White', theme: 'css/theme/white.css' },
		//     { name: 'League', theme: 'css/theme/league.css' }
		// ]
		themes: false,
		// Specifies the path to the default theme files.
		themesPath: 'css/theme/',
		// Specifies if the transitions menu panel will be shown.
		transitions: false,
		// Adds a menu button to the slides to open the menu panel.
		openButton: true,
		// Allows the slide number to open the menu panel
		openSlideNumber: false,
		// Allows the user to open and navigate the menu using the keyboard.
		keyboard: true,
		// Leave the menu open until it is explicitly closed
		sticky: false,
		// If 'true' the menu will not be created until it is explicitly
		// requested by calling RevealMenu.init().
		delayInit: false,
		// If 'true' the menu will be shown when the menu is initialised.
		openOnInit: false,
		// By default the menu will load it's own font-awesome library
		// icons. If your presentation needs to load a different
		// font-awesome library the 'loadIcons' option can be set to false
		// and the menu will not attempt to load the font-awesome library.
		loadIcons: true
	},
    plugins: [ RevealHighlight, RevealMath, RevealMenu ]
});

Reveal.on( 'ready', event => {
    // Add "contenteditable" attribute to all tags with the "contenteditable" CSS class.
    document.querySelectorAll('.contenteditable').forEach( el => el.setAttribute("contenteditable","true"));
});

</script>

</body>
</html>
